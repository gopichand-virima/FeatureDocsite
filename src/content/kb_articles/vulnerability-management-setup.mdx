---
id: vulnerability-management-setup
title: Vulnerability Management Setup and Configuration
category: Security
module: Vulnerability Management
difficulty: Advanced
readTime: 22 min
lastUpdated: 2024-11-28
author: Virima Technical Documentation Team
tags:
  - security
  - vulnerability
  - compliance
  - patching
relatedArticles:
  - compliance-reporting
  - patch-management
  - security-dashboard
---

# Vulnerability Management Setup and Configuration

Complete guide to configuring Virima's Vulnerability Management module for comprehensive security posture management and compliance reporting.

## Table of Contents

1. [Overview](#overview)
2. [Initial Setup](#initial-setup)
3. [Vulnerability Scanning](#vulnerability-scanning)
4. [Risk Assessment](#risk-assessment)
5. [Remediation Workflows](#remediation-workflows)
6. [Compliance Reporting](#compliance-reporting)
7. [Integration with Patch Management](#integration-with-patch-management)

## Overview

Virima Vulnerability Management provides comprehensive vulnerability scanning, assessment, and remediation tracking integrated with your CMDB and patch management processes.

### Key Features

- **Automated Vulnerability Scanning** - Continuous security assessment
- **CVE Database Integration** - Real-time threat intelligence
- **Risk-Based Prioritization** - Focus on critical vulnerabilities
- **Patch Correlation** - Link vulnerabilities to available patches
- **Compliance Mapping** - Track against security frameworks
- **Remediation Tracking** - Monitor fix progress and SLAs

### Supported Frameworks

✅ NIST Cybersecurity Framework
✅ PCI DSS
✅ HIPAA
✅ SOC 2
✅ ISO 27001
✅ CIS Controls
✅ GDPR Technical Requirements

## Initial Setup

### Prerequisites

**System Requirements:**
- Virima Discovery module configured
- CMDB populated with assets
- Network access to vulnerability scanners
- Integration credentials for security tools

**Required Integrations:**
```yaml
Vulnerability Scanners:
  - Qualys
  - Tenable Nessus
  - Rapid7 InsightVM
  - OpenVAS
  
Threat Intelligence:
  - National Vulnerability Database (NVD)
  - MITRE CVE Database
  - Vendor Security Bulletins
  
Patch Management:
  - WSUS (Windows)
  - SCCM
  - Red Hat Satellite
  - Third-party patching tools
```

### Step 1: Configure Scanner Integration

Navigate to **Security → Vulnerability Management → Scanners**

**Qualys Integration Example:**
```yaml
Scanner Configuration:
  Name: Qualys Production Scanner
  Type: Qualys
  API URL: https://qualysapi.qualys.com
  Username: api_user@company.com
  Password: ••••••••••
  
  Scan Settings:
    Auto-Import: Enabled
    Import Frequency: Every 6 hours
    Asset Matching: By IP Address
    Create CIs: For unknown assets
  
  Data Mapping:
    Vulnerability Severity: Use QDS Score
    Risk Level: Auto-calculate
    Compliance: Map to frameworks
```

**Nessus Integration:**
```yaml
Scanner Configuration:
  Name: Nessus Enterprise
  Type: Tenable Nessus
  Server URL: https://nessus.company.com:8834
  Access Key: xxxxxxxxxxxxxxxx
  Secret Key: ••••••••••
  
  Import Settings:
    Scan Results: All scans
    Frequency: Real-time via webhook
    Historical Data: Last 90 days
```

### Step 2: Asset Correlation

Link vulnerability data to CMDB CIs:

**Correlation Methods:**

1. **IP Address Matching**
   - Primary method for most assets
   - Handles multiple IPs per device
   - Supports IP changes over time

2. **Hostname Matching**
   - Fallback for DNS-named systems
   - Case-insensitive matching
   - FQDN normalization

3. **MAC Address Matching**
   - For network devices
   - Handles multiple MACs
   - Persistence across IP changes

**Correlation Rules:**
```javascript
Rule 1: Exact IP Match
if (scan_ip == cmdb_ci.ip_address) {
  link_vulnerability(scan_result, cmdb_ci);
  confidence = 100%;
}

Rule 2: Hostname Match
if (normalize(scan_hostname) == normalize(cmdb_ci.hostname)) {
  link_vulnerability(scan_result, cmdb_ci);
  confidence = 95%;
}

Rule 3: MAC Address Match
if (scan_mac in cmdb_ci.mac_addresses) {
  link_vulnerability(scan_result, cmdb_ci);
  confidence = 90%;
}

Rule 4: Multiple Matches
if (multiple_matches_found) {
  flag_for_manual_review();
  select_most_recent_ci();
}
```

### Step 3: Severity Classification

Configure severity levels:

| Severity | CVSS Score | Risk Level | SLA | Actions |
|----------|------------|------------|-----|---------|
| Critical | 9.0-10.0 | Critical | 7 days | Immediate patch |
| High | 7.0-8.9 | High | 30 days | Prioritize patching |
| Medium | 4.0-6.9 | Medium | 90 days | Scheduled patching |
| Low | 0.1-3.9 | Low | 180 days | Optional patching |
| Info | 0.0 | Informational | N/A | Awareness only |

**Custom Severity Adjustments:**
```yaml
Adjustment Rule: Internet-Facing Systems
Condition: Asset has public IP or in DMZ
Action: Increase severity by 1 level
Example: High → Critical

Adjustment Rule: Legacy Systems
Condition: OS end-of-life
Action: Increase severity by 1 level
Note: No patches available

Adjustment Rule: Compensating Controls
Condition: WAF or IPS protection active
Action: Decrease severity by 1 level
Note: Document control
```

## Vulnerability Scanning

### Scan Types

**1. Authenticated Scans**
- Full system access with credentials
- Deep vulnerability assessment
- Software inventory
- Configuration audits
- Recommended for all internal systems

**Configuration:**
```yaml
Scan Profile: Authenticated Internal Scan
Credentials: Use CMDB credentials
Scope: All internal assets
Plugins:
  - Operating System vulnerabilities
  - Installed software vulnerabilities  
  - Configuration compliance
  - Patch level assessment
  - Service enumeration
Frequency: Weekly
```

**2. Unauthenticated Scans**
- Network-level scanning
- No credentials required
- Limited vulnerability detection
- Use for DMZ and external assets

**Configuration:**
```yaml
Scan Profile: External Perimeter Scan
Credentials: None
Scope: Public-facing IPs
Plugins:
  - Network service vulnerabilities
  - Web application scanning
  - SSL/TLS configuration
  - Open ports and services
Frequency: Daily
```

**3. Web Application Scans**
- OWASP Top 10 testing
- SQL injection, XSS, CSRF
- Authentication testing
- API security assessment

**Configuration:**
```yaml
Scan Profile: Web Application Security
Type: Dynamic Application Security Testing (DAST)
Targets: Web applications from CMDB
Tests:
  - OWASP Top 10
  - Business logic flaws
  - Authentication/Authorization
  - Session management
  - Input validation
Frequency: After each deployment
```

### Scan Scheduling

**Best Practice Schedule:**

```yaml
Production Servers:
  Full Authenticated Scan: Sunday 2:00 AM
  Quick Scan: Daily 3:00 AM
  External Scan: Continuous
  
Development/Test:
  Full Scan: Weekly
  Quick Scan: As needed
  
Workstations:
  Full Scan: Saturday night
  Quick Scan: Weekly
  
DMZ Systems:
  External Scan: Continuous
  Internal Scan: Daily
  
Critical Infrastructure:
  Scan: Daily
  Real-time monitoring: Enabled
```

**Scan Windows:**
```yaml
Business Hours: 8 AM - 6 PM
Allowed Scan Times: Outside business hours
Exceptions:
  - Development systems: Anytime
  - DMZ: Anytime
  - Critical systems: Requires approval
  
Blackout Periods:
  - Change freeze windows
  - Holiday periods
  - Major project deployments
```

## Risk Assessment

### Risk Calculation

Virima calculates risk using multiple factors:

**Risk Formula:**
```javascript
Risk Score = (CVSS Base Score × Asset Criticality × Exploitability × Exposure) / Mitigating Controls

Where:
- CVSS Base Score: 0-10 from CVE database
- Asset Criticality: 1-5 (configured per CI)
- Exploitability: 0.5-2.0 (based on exploit availability)
- Exposure: 0.5-2.0 (internal vs external)
- Mitigating Controls: 0.5-1.0 (discount factor)
```

**Example Calculation:**

```yaml
Vulnerability: CVE-2024-1234 (Remote Code Execution)
CVSS Score: 9.8 (Critical)

Asset: Production Web Server
Criticality: 5 (Business Critical)
Exploitability: 2.0 (Public exploit available)
Exposure: 2.0 (Internet-facing)
Mitigating Controls: 0.8 (WAF in place)

Risk Score = (9.8 × 5 × 2.0 × 2.0) / 0.8 = 245

Risk Level: CRITICAL (Score > 200)
```

### Asset Criticality

Define asset criticality levels:

| Level | Description | Examples | Priority |
|-------|-------------|----------|----------|
| 5 - Critical | Business cannot function | Payment systems, core databases | Highest |
| 4 - High | Major business impact | Email, CRM, ERP | High |
| 3 - Medium | Moderate impact | Internal tools, file servers | Medium |
| 2 - Low | Minimal impact | Test systems, development | Low |
| 1 - Informational | No business impact | Decommissioned, lab | Lowest |

**Auto-Classification Rules:**
```yaml
Rule: Production Database Servers
Conditions:
  - CI Class = "Database Server"
  - Environment = "Production"
  - Service Tier = "Tier 1"
Action: Set Criticality = 5

Rule: Internet-Facing Web Servers
Conditions:
  - CI Class = "Web Server"
  - Has Public IP
  - Serves Customer Traffic
Action: Set Criticality = 5

Rule: End-User Workstations
Conditions:
  - CI Class = "Workstation"
  - Standard user device
Action: Set Criticality = 2
```

### Threat Intelligence Integration

Incorporate threat intelligence:

**Data Sources:**
```yaml
Exploit Databases:
  - Exploit-DB
  - Metasploit Framework
  - Packet Storm
  
Threat Feeds:
  - CISA Known Exploited Vulnerabilities
  - MITRE ATT&CK
  - Vendor security advisories
  
Indicators:
  - Exploit availability (yes/no)
  - Active exploitation (in the wild)
  - Weaponization (malware families)
  - Trending vulnerabilities
```

**Risk Adjustments:**
```javascript
if (exploit_publicly_available) {
  exploitability_factor = 2.0;
}

if (active_exploitation_detected) {
  exploitability_factor = 2.0;
  escalate_priority();
  notify_security_team();
}

if (ransomware_associated) {
  risk_level = "CRITICAL";
  immediate_action_required = true;
}
```

## Remediation Workflows

### Automated Remediation

Configure automated remediation for qualifying vulnerabilities:

**Auto-Remediation Rules:**
```yaml
Rule: Auto-Patch Low-Risk Vulnerabilities
Conditions:
  - Severity: Low or Medium
  - Asset Criticality: 1-2
  - Patch Available: Yes
  - Test Status: Passed
Actions:
  - Create patch deployment task
  - Schedule during maintenance window
  - Auto-approve
  - Deploy patch
  - Verify remediation
  - Close vulnerability

Rule: Notify for Manual Remediation
Conditions:
  - Severity: High or Critical
  - OR Asset Criticality: 4-5
Actions:
  - Create remediation ticket
  - Assign to asset owner
  - Set SLA based on severity
  - Track until closed
```

### Manual Remediation Process

**Workflow Steps:**

```mermaid
1. Vulnerability Detected
   ↓
2. Risk Assessment
   ↓
3. Create Remediation Task
   ↓
4. Assign to Owner
   ↓
5. Review Patch/Fix
   ↓
6. Test in Dev/QA
   ↓
7. Create Change Request
   ↓
8. Approve Change
   ↓
9. Deploy Remediation
   ↓
10. Verify Fix
   ↓
11. Close Vulnerability
```

**Remediation Options:**

| Option | Description | Use Case |
|--------|-------------|----------|
| Patch | Apply vendor patch | Standard remediation |
| Workaround | Temporary mitigation | Patch not available |
| Configuration Change | Adjust settings | Config vulnerability |
| Compensating Control | Additional security layer | Cannot patch |
| Accept Risk | Document and accept | Business decision required |
| Retire Asset | Decommission system | End-of-life systems |

### Exception Management

Handle vulnerabilities that cannot be immediately remediated:

**Exception Request Form:**
```yaml
Vulnerability Exception Request
  Vulnerability: CVE-2024-XXXX
  Affected Assets: [List CIs]
  Severity: High
  Risk Score: 156
  
  Reason for Exception:
    - [ ] No patch available
    - [ ] Business-critical system, cannot patch
    - [x] Testing in progress
    - [ ] Compensating controls in place
  
  Compensating Controls:
    - WAF rule implemented
    - Network segmentation applied
    - Enhanced monitoring enabled
  
  Exception Duration: 90 days
  
  Business Justification:
    System supports critical Q4 campaign. Patching scheduled
    for maintenance window on 2024-12-15. WAF rules mitigate
    immediate risk.
  
  Approvals Required:
    - Asset Owner: [Name]
    - Security Team: [Name]
    - CISO: [Name] (for Critical/High)
```

**Exception Tracking:**
- Exceptions logged in security dashboard
- Regular review (monthly)
- Auto-notification before expiration
- Re-assessment required for renewal

## Compliance Reporting

### Framework Mapping

Map vulnerabilities to compliance requirements:

**PCI DSS Example:**
```yaml
PCI DSS Requirement 6.2: Protect all systems against malware

Mapped Controls:
  - All systems scanned for vulnerabilities
  - Critical/High vulnerabilities patched within 30 days
  - Quarterly internal vulnerability scans
  - Quarterly external vulnerability scans
  - Re-scans after remediation

Virima Metrics:
  - Scan Coverage: 100% of in-scope assets
  - Patch Compliance: % patched within SLA
  - Scan Frequency: Actual vs required
  - Open Vulnerabilities: Count by severity
  - Mean Time to Remediate: By severity
```

**NIST CSF Mapping:**
```yaml
NIST CSF Category: Identify (ID)
Subcategory: ID.RA-1 - Asset vulnerabilities are identified

Virima Evidence:
  - Asset inventory from CMDB
  - Vulnerability scan results
  - Risk scores per asset
  - Remediation tracking
  - Exception documentation

Reports Available:
  - Asset Vulnerability Summary
  - Risk Heat Map
  - Trend Analysis
  - Remediation Progress
```

### Compliance Dashboards

**Executive Dashboard:**
```yaml
Metrics Displayed:
  - Overall Security Posture Score (0-100)
  - Critical Vulnerabilities: Count and trend
  - Patch Compliance Rate: % and trend
  - Mean Time to Remediate: By severity
  - Assets at Risk: Count and percentage
  - Compliance Status: By framework
  
Visualization:
  - Trend charts (90 days)
  - Heat maps (risk by asset group)
  - Compliance gauges
  - Top 10 risks table
  
Frequency: Real-time, updated hourly
```

**Operational Dashboard:**
```yaml
Metrics Displayed:
  - New Vulnerabilities: Last 24 hours
  - Open Vulnerabilities: By severity and age
  - SLA Status: On-track vs at-risk
  - Remediation Progress: % complete
  - Scan Coverage: % assets scanned recently
  - Failed Scans: Count and reasons
  
Actions Available:
  - Drill-down to vulnerability details
  - Assign remediation tasks
  - Create exception requests
  - Export data for reporting
  
Frequency: Real-time
```

### Audit Reports

Generate compliance audit reports:

**Quarterly Vulnerability Report:**
```markdown
## Executive Summary
- Total Assets Scanned: 5,432
- Total Vulnerabilities: 12,847
- Critical: 23 (0.2%)
- High: 156 (1.2%)
- Medium: 3,421 (26.6%)
- Low: 9,247 (72.0%)

## Compliance Status
- PCI DSS: ✓ Compliant
- HIPAA: ✓ Compliant
- SOC 2: ⚠ 2 findings pending
- ISO 27001: ✓ Compliant

## Key Metrics
- Patch Compliance: 98.7% (Target: 95%)
- MTTR Critical: 4.2 days (Target: 7 days)
- MTTR High: 18.5 days (Target: 30 days)
- Scan Coverage: 99.8% (Target: 100%)

## Top Risks
1. CVE-2024-XXXX: 45 systems affected
2. CVE-2024-YYYY: 23 systems affected
...

## Remediation Progress
- Vulnerabilities Closed This Quarter: 8,921
- Outstanding: 3,926
- Exceptions: 15 (reviewed and approved)

## Recommendations
1. Focus on patching CVE-2024-XXXX
2. Upgrade 12 end-of-life systems
3. Implement WAF for web servers
```

## Integration with Patch Management

### Automated Patch Correlation

Link vulnerabilities to available patches:

```yaml
Correlation Process:
  1. Vulnerability detected (CVE-2024-XXXX)
  2. Query patch database for matching KB/bulletin
  3. Check patch availability in WSUS/SCCM
  4. Verify patch compatibility with affected systems
  5. Link vulnerability to patch
  6. Create deployment task if auto-approved
  
Example:
  Vulnerability: CVE-2024-12345
  Affected: 45 Windows Servers
  Patch Available: KB5012345 (Windows Update)
  Status: Available in WSUS
  Action: Create deployment for patch group "Servers-Prod"
  Schedule: Next maintenance window (Saturday 2 AM)
```

### Patch Testing Workflow

```yaml
Patch Testing Process:
  1. New vulnerability/patch identified
  2. Deploy to test environment
     - Test systems: 3-5 representative servers
     - Test duration: 48-72 hours
     - Monitoring: Application functionality, performance
  
  3. Test validation
     - Application tests: Pass/Fail
     - Performance impact: Acceptable/Not acceptable
     - Vulnerability rescan: Verify remediation
  
  4. Approval gate
     - Test results reviewed
     - Change control approval
     - Production deployment approved
  
  5. Phased rollout
     - Pilot group: 10% of systems
     - Monitor: 24 hours
     - Full deployment: Remaining systems
  
  6. Verification
     - Rescan affected systems
     - Confirm vulnerability closed
     - Update remediation status
```

## Best Practices

### 1. Continuous Scanning

```yaml
Scanning Strategy:
  Critical Assets:
    - Scan: Daily
    - Method: Authenticated
    - Re-scan after changes: Yes
  
  Standard Assets:
    - Scan: Weekly
    - Method: Authenticated
    - Re-scan after patches: Yes
  
  Low-Priority Assets:
    - Scan: Monthly
    - Method: Unauthenticated acceptable
```

### 2. Vulnerability Prioritization

**Priority Framework:**
```javascript
Priority = (Severity × Asset Criticality × Exploitability × Business Impact) - Mitigating Controls

Decision Matrix:
if (priority > 500) {
  remediation_sla = "24 hours";
  approval_required = "CISO";
} else if (priority > 200) {
  remediation_sla = "7 days";
  approval_required = "Security Manager";
} else if (priority > 100) {
  remediation_sla = "30 days";
  approval_required = "Team Lead";
} else {
  remediation_sla = "90 days";
  approval_required = "Standard process";
}
```

### 3. Metrics and KPIs

**Track These Metrics:**

| Metric | Target | Measurement Frequency |
|--------|--------|-----------------------|
| Vulnerability Discovery Rate | Trend analysis | Weekly |
| Mean Time to Detect (MTTD) | <24 hours | Daily |
| Mean Time to Remediate (MTTR) - Critical | <7 days | Daily |
| Mean Time to Remediate (MTTR) - High | <30 days | Weekly |
| Patch Compliance Rate | >95% | Daily |
| Scan Coverage | 100% | Daily |
| False Positive Rate | <5% | Monthly |
| Exception Rate | <2% | Monthly |

## Summary

Effective vulnerability management requires:
- ✅ Comprehensive scanning coverage
- ✅ Risk-based prioritization
- ✅ Automated remediation where possible
- ✅ Integration with patch management
- ✅ Compliance reporting
- ✅ Continuous improvement

## Additional Resources

- [Patch Management Guide](/kb/patch-management)
- [Compliance Reporting](/kb/compliance-reporting)
- [Security Dashboard Configuration](/kb/security-dashboard)
- [NIST National Vulnerability Database](https://nvd.nist.gov/)
- [Video Tutorial: Vulnerability Management](https://virima.com/videos/vulnerability-management)

---

**Need Help?** Contact Virima Support at support@virima.com

*Last Updated: November 28, 2024 | Article ID: KB004*
