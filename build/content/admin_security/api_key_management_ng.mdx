# API Key Management

Use this function to create, manage, and monitor API keys for programmatic access to Virima.

API keys enable secure integration with external systems, automation scripts, and third-party applications while maintaining security and auditability.

In the main window, click **Admin > Security > API Key Management**. The API Key Management window displays.

## Overview

API keys provide:

- Secure programmatic access to Virima APIs
- Authentication for integrations
- Access control for automated processes
- Usage tracking and monitoring
- Rate limiting and quotas

## API Key List

View all API keys:

**Key Columns**:

- **Key Name**: Descriptive name
- **Key ID**: Unique identifier
- **Type**: Full Access, Read-Only, Custom
- **Owner**: User who created the key
- **Created**: Creation date
- **Last Used**: Last usage timestamp
- **Expires**: Expiration date
- **Status**: Active, Inactive, Expired, Revoked

## Create New API Key

From the *Select Actions* drop-down list, choose **New API Key**. The New API Key window displays.

### Basic Information

**Key Details**:

- **Key Name**: Descriptive name (e.g., "ServiceNow Integration")
- **Description**: Purpose and usage
- **Owner**: User or application name
- **Environment**: Production, Staging, Development

### Key Type and Permissions

**Access Level**:

**Full Access API Key**:

- Complete read/write access to all modules
- Equivalent to admin privileges
- ⚠️ Use with extreme caution

**Read-Only API Key**:

- Read access to all modules
- Cannot create, update, or delete
- Safe for reporting and monitoring

**Custom Permissions**:

- Define specific permissions
- Granular access control
- Recommended for most use cases

Select **Custom Permissions** for security.

### Configure Permissions

**Module Access**:

**Incidents**:

- ☑ Read incidents
- ☑ Create incidents
- ☑ Update incidents
- ☐ Delete incidents

**Service Requests**:

- ☑ Read requests
- ☑ Create requests
- ☐ Update requests
- ☐ Delete requests

**Assets**:

- ☑ Read assets
- ☐ Create assets
- ☐ Update assets
- ☐ Delete assets

**Users**:

- ☑ Read users (basic info only)
- ☐ Create users
- ☐ Update users
- ☐ Delete users

**Configuration**:

- ☐ Read configuration
- ☐ Modify configuration
- ☐ Admin functions

**Specific Endpoints**:

Define allowed API endpoints:

```
GET /api/v1/incidents
POST /api/v1/incidents
GET /api/v1/assets
GET /api/v1/users
```

### Security Settings

**Expiration**:

- **Never Expires**: ☐ (not recommended)
- **Expires After**: 365 days
- **Expiration Date**: 2025-01-27

**IP Restrictions**:

- **Allow from Any IP**: ☐
- **Restrict to Specific IPs**: ☑

Add allowed IP addresses:

```
192.168.1.0/24 (Office Network)
10.0.50.100 (Integration Server)
203.0.113.45 (Cloud Service)
```

**Referrer Restrictions**:

- Limit to specific domains/applications
- Prevent unauthorized use

**CORS Settings**:

- Configure allowed origins for browser-based apps

### Rate Limiting

**Request Limits**:

- **Requests per Minute**: 100
- **Requests per Hour**: 5,000
- **Requests per Day**: 100,000
- **Burst Limit**: 200 requests

**Quota Management**:

- **Monthly Request Quota**: 1,000,000 requests
- **Warning Threshold**: 80%
- **Action on Exceeded**: Throttle or Block

**Concurrent Requests**:

- **Max Concurrent**: 10 requests

### Notification Settings

**Alerts**:

- ☑ Alert on first use
- ☑ Alert on unusual usage patterns
- ☑ Alert approaching expiration (30 days)
- ☑ Alert on quota threshold (80%)
- ☑ Alert on IP violation attempt

**Recipients**:

- Key owner
- Security team
- Integration team

Click **Generate API Key**.

## View and Copy API Key

**⚠️ IMPORTANT**: The API key is shown only once at creation.

**Generated API Key**:

```
virima_live_sk_a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6
```

**Copy Key**: Click to copy to clipboard

**Download Key**: Save to secure location

**QR Code**: For mobile app configuration

**Security Recommendations**:

- Store in secure credential management system
- Never commit to version control
- Use environment variables
- Rotate regularly

Click **I Have Saved the Key** to continue.

## API Key Authentication

### Using API Keys

**HTTP Header Authentication**:

```http
GET /api/v1/incidents HTTP/1.1
Host: virima.company.com
Authorization: Bearer virima_live_sk_a1b2c3d4...
Content-Type: application/json
```

**Query Parameter** (not recommended):

```
GET /api/v1/incidents?api_key=virima_live_sk_a1b2c3d4...
```

**Basic Auth** (legacy):

```
Username: api_key
Password: virima_live_sk_a1b2c3d4...
```

### Example API Requests

**Create Incident**:

```bash
curl -X POST https://virima.company.com/api/v1/incidents \
  -H "Authorization: Bearer virima_live_sk_a1b2c3d4..." \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Server Down",
    "priority": "Critical",
    "description": "Production server not responding"
  }'
```

**Get Asset**:

```bash
curl -X GET https://virima.company.com/api/v1/assets/12345 \
  -H "Authorization: Bearer virima_live_sk_a1b2c3d4..."
```

## Monitor API Key Usage

View usage statistics for API keys:

Select an API key.

Click **View Usage**.

### Usage Metrics

**Request Statistics**:

- **Total Requests**: 45,234
- **Requests Today**: 1,234
- **Average Daily**: 1,500
- **Peak Requests/Hour**: 456
- **Success Rate**: 98.5%

**Endpoint Usage**:

| Endpoint | Requests | Success | Errors |
|----------|----------|---------|--------|
| GET /incidents | 20,123 | 19,980 | 143 |
| POST /incidents | 5,678 | 5,650 | 28 |
| GET /assets | 15,234 | 15,190 | 44 |
| PATCH /incidents | 4,199 | 4,180 | 19 |

**Error Analysis**:

- 401 Unauthorized: 15
- 403 Forbidden: 8
- 429 Rate Limited: 102
- 500 Server Error: 12

**Geographic Usage**:

- United States: 80%
- Canada: 15%
- United Kingdom: 5%

### Usage Trends

**Charts**:

- Requests over time
- Success rate trend
- Error rate trend
- Quota utilization

**Time Periods**:

- Last 24 hours
- Last 7 days
- Last 30 days
- Custom range

### Request Log

View detailed request log:

**Recent Requests**:

| Timestamp | Endpoint | Method | IP Address | Status | Response Time |
|-----------|----------|--------|------------|--------|---------------|
| 14:23:15 | /incidents | POST | 10.0.50.100 | 201 | 145ms |
| 14:23:10 | /incidents | GET | 10.0.50.100 | 200 | 78ms |
| 14:23:05 | /assets/123 | GET | 10.0.50.100 | 200 | 52ms |

**Export Request Log**: For analysis or compliance

## Rotate API Key

Rotate keys periodically for security:

Select an API key.

From the *Select Actions* drop-down list, choose **Rotate Key**.

**Rotation Options**:

**Immediate Rotation**:

- Generate new key immediately
- Old key revoked instantly
- Update all integrations immediately

**Gradual Rotation**:

- Generate new key
- Keep both keys active for transition period (7, 30, 90 days)
- Migrate integrations gradually
- Auto-revoke old key after period

**Rotation Strategy**:

Select **Gradual Rotation** with 30-day overlap.

Click **Generate New Key**.

**New API Key Generated**:

```
virima_live_sk_x9y8z7w6v5u4t3s2r1q0p9o8n7m6l5k4
```

**Old Key**: Active until 2024-02-27

Update integrations with new key before expiration.

## Revoke API Key

Immediately disable an API key:

Select an API key.

From the *Select Actions* drop-down list, choose **Revoke Key**.

**Revocation Reason**:

- Compromised/exposed
- No longer needed
- Employee departure
- Security policy
- Scheduled rotation

**Impact Warning**: All requests using this key will be rejected immediately.

Confirm revocation.

**Revoked Key**: Cannot be reactivated. Create new key if needed.

## API Key Policies

Configure organization-wide API key policies:

Click **API Key Policies**.

### Security Policies

**Mandatory Settings**:

- ☑ Require expiration (max 1 year)
- ☑ Require IP restrictions
- ☑ Enable rate limiting
- ☑ Log all API requests
- ☐ Allow full access keys (disabled)

**Rotation Policy**:

- Recommend rotation every: 90 days
- Force rotation every: 365 days
- Send reminder: 30 days before expiration

**Approval Requirements**:

- Require manager approval for API keys
- Require security team review for full access
- Auto-approve read-only keys

### Naming Conventions

**Required Format**:

- Include environment (prod/staging/dev)
- Include application name
- Include purpose
- Example: "prod-servicenow-incident-sync"

### Audit Requirements

**Logging**:

- Log all key creation/revocation
- Log all API requests
- Log all failed authentication attempts
- Retain logs for 1 year

**Review**:

- Quarterly access review
- Unused key cleanup (no use in 90 days)
- Owner verification

Click **Save Policies**.

## Bulk Key Management

Manage multiple keys:

### Filter Keys

- Keys expiring soon (30 days)
- Unused keys (no use in 90 days)
- Keys by owner
- Keys by environment

### Bulk Actions

Select multiple keys (checkboxes).

**Available Actions**:

- Extend expiration
- Revoke selected
- Change rate limits
- Update notifications
- Export key details

## API Key Templates

Create templates for common use cases:

Click **Create Template**.

**Template: Read-Only Monitoring**:

- Read access to all modules
- No write permissions
- Rate limit: 500/hour
- Expiration: 180 days

**Template: Incident Integration**:

- Read/write incidents only
- Read users and assets
- Rate limit: 100/minute
- Expiration: 365 days
- IP restricted

**Template: Asset Discovery**:

- Read/write assets
- Read discovery data
- High rate limit: 1000/minute
- IP restricted to discovery servers

Save and reuse templates for consistent key creation.

## API Documentation

Access API documentation:

Click **View API Documentation**.

- Interactive API explorer
- Endpoint reference
- Authentication guide
- Code examples (Python, JavaScript, cURL)
- Rate limiting details
- Error codes reference

## Other Functions and Page Elements

- [Auto Refresh](/common_topics/auto_refresh_ng.mdx)
- [Delete](/common_topics/delete_remove_ng.mdx)
- [Export](/discovery/import_data_files/export_ng.mdx)
- [Personalize Columns](/common_topics/personalize_columns_ng.mdx)
- [Saved Filters](/common_topics/saved_filters_ng.mdx)
